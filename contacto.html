<!doctype html>
<html lang="es">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1, viewport-fit=cover" />
  <meta name="theme-color" content="#0ea5a4" />
  <meta name="description" content="Contacta con el equipo del Sistema Vehicular Unificado - Dudas, sugerencias y soporte" />
  <title>Ponte en Contacto - Sistema Vehicular Unificado</title>
  <link rel="stylesheet" href="css/styles.css">
  <link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Material+Symbols+Outlined:opsz,wght,FILL,GRAD@24,400,0,0" />
  <link href="https://fonts.googleapis.com/css2?family=Roboto:wght@400;500;700&display=swap" rel="stylesheet">
  <link href="https://fonts.googleapis.com/css2?family=Roboto+Serif:wght@400;600;700&display=swap" rel="stylesheet">
  <script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-app-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-database-compat.js"></script>
</head>
<body>
  <header class="app-header material-header">
    <div class="header-logos-marquee">
      <div class="header-logos-scroll">
        <img src="recursos/satlima_100.png" alt="SAT Lima" height="28" />
        <img src="recursos/satcallao_100.png" alt="SAT Callao" height="28" />
        <img src="recursos/sunarp_100.png" alt="SUNARP" height="28" />
        <img src="recursos/sutran_100.png" alt="SUTRAN" height="28" />
        <img src="recursos/atu_100.png" alt="ATU" height="28" />
        <img src="recursos/pnp_100.png" alt="PNP" height="28" />
        <img src="recursos/sbs_100.png" alt="SBS" height="28" />
        <img src="recursos/sunat_100.png" alt="SUNAT" height="28" />
        <img src="recursos/minister_100.png" alt="Ministerio" height="28" />
        <img src="recursos/satlima_100.png" alt="SAT Lima" height="28" />
        <img src="recursos/satcallao_100.png" alt="SAT Callao" height="28" />
        <img src="recursos/sunarp_100.png" alt="SUNARP" height="28" />
        <img src="recursos/sutran_100.png" alt="SUTRAN" height="28" />
        <img src="recursos/atu_100.png" alt="ATU" height="28" />
        <img src="recursos/pnp_100.png" alt="PNP" height="28" />
        <img src="recursos/sbs_100.png" alt="SBS" height="28" />
        <img src="recursos/sunat_100.png" alt="SUNAT" height="28" />
        <img src="recursos/minister_100.png" alt="Ministerio" height="28" />
      </div>
    </div>
  </header>
  
  <button class="fab-back" onclick="window.location.href='index.html'" aria-label="Volver">
    <span class="material-symbols-outlined">arrow_back</span>
  </button>
  <main class="main-content contact-content">
    <form id="contactForm" class="md-card md-form">
      <div class="md-info">
        Tu información está segura y respaldada en Google Firebase. Solo se usa para responder tu consulta.
      </div>
      <!-- Honeypot anti-bot: no rellenar -->
      <input type="text" id="hp_website" name="website" class="hp-field" tabindex="-1" aria-hidden="true" autocomplete="off" />
      <label for="nombre" class="md-label">Nombre</label>
      <input type="text" id="nombre" name="nombre" class="md-input" required placeholder="Tu nombre" minlength="2" maxlength="80" />
      
      <label for="correo" class="md-label">Correo electrónico</label>
      <input type="email" id="correo" name="correo" class="md-input" required placeholder="tucorreo@ejemplo.com" maxlength="120" />
      
      <label for="mensaje" class="md-label">Mensaje</label>
      <textarea id="mensaje" name="mensaje" rows="5" class="md-textarea" required placeholder="Cuéntanos en qué podemos ayudarte" maxlength="1000"></textarea>
      
      <button type="submit" id="sendBtn" class="md-button primary full">
        Enviar
      </button>
      <div id="formStatus" class="md-status"></div>
    </form>
  </main>
  <footer class="footer"></footer>
  <script>
    // Configura tus credenciales de Firebase aquí
    const firebaseConfig = {
      apiKey: "AIzaSyCckXC-NxDumgr0bN92rloTMbWGdfN86OE",
      authDomain: "system-cd633.firebaseapp.com",
      databaseURL: "https://system-cd633-default-rtdb.firebaseio.com",
      projectId: "system-cd633",
      storageBucket: "system-cd633.firebasestorage.app",
      messagingSenderId: "524876781374",
      appId: "1:524876781374:web:1bf219ae6081eb3c9f3e6f",
      measurementId: "G-XEH674PFWG"
    };
    // Inicialización segura (evita doble init si el script se carga 2 veces)
    try { if (!firebase.apps.length) { firebase.initializeApp(firebaseConfig); } } catch(e) {}
    const db = firebase.database();

    const form = document.getElementById('contactForm');
    const statusEl = document.getElementById('formStatus');
    const sendBtn = document.getElementById('sendBtn');

    form.addEventListener('submit', function(e) {
      e.preventDefault();
      // Honeypot
      const hp = document.getElementById('hp_website').value;
      if (hp) { return; } // Bot detectado: abortar silenciosamente

      const nombre = document.getElementById('nombre').value.trim();
      const correo = document.getElementById('correo').value.trim();
      const mensaje = document.getElementById('mensaje').value.trim();

      // Validación simple
      const emailOk = /^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(correo);
      if (!nombre || !emailOk || !mensaje) {
        statusEl.textContent = 'Por favor, completa los campos correctamente.';
        return;
      }

      // UI estado
      sendBtn.disabled = true; sendBtn.setAttribute('aria-busy','true'); statusEl.textContent = 'Enviando...';

      db.ref('contacto/messages').push({ nombre, correo, mensaje, createdAt: firebase.database.ServerValue.TIMESTAMP })
        .then(() => {
          statusEl.textContent = '¡Mensaje enviado correctamente!';
          form.reset();
        })
        .catch(() => {
          statusEl.textContent = 'Error al enviar. Intenta nuevamente.';
        })
        .finally(() => {
          sendBtn.disabled = false; sendBtn.removeAttribute('aria-busy');
        });
    });
  </script>

  <nav class="bottom-nav">
    <a href="index.html" class="nav-item">
      <span class="material-symbols-outlined">home</span>
      <span class="nav-label">Inicio</span>
    </a>
    <a href="acerca.html" class="nav-item">
      <span class="material-symbols-outlined">info</span>
      <span class="nav-label">Acerca</span>
    </a>
    <a href="privacidad.html" class="nav-item">
      <span class="material-symbols-outlined">privacy_tip</span>
      <span class="nav-label">Privacidad</span>
    </a>
    <a href="contacto.html" class="nav-item nav-item-active">
      <span class="material-symbols-outlined">contact_support</span>
      <span class="nav-label">Contacto</span>
    </a>
  </nav>
</body>
</html>